<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7,IE=edge"><meta name="viewport" content="width=device-width"><meta name="generator" content="DocPad v6.65.0" /><link  rel="stylesheet" href="/blog/style.css" /></head><body><div class="page"><h1 class="page-head">Архив клуба разработки интерфейсов</h1><div class="page-content"><header><h1>yaTouchSlider — слайдер для тач-устройств</h1><p>Опубликовано Thu Jul 24 2014 14:59:42 GMT+0400 (MSK). Автор: Кирилл Белевич.</p></header><p>На многих известных нам мобильных сайтах для тач-устройств слайдеры (листалки) устроены так, что анимация происходит уже после свайп-жеста, после того как человек убрал палец. Это не так красиво и не так удобно, как в нативных слайдерах, например, на главных экранах iOS-устройств.</p>
<p><a href="http://yandex.ru/touchsearch?text=Погода"><img src="http://img-fotki.yandex.ru/get/5112/1076905.1/0_60dfe_1b30ce61_orig" alt="QR-код на результаты поиска по слову «Погода»"></a></p>
<p>Мы сделали jQuery-плагин, который помогает сделать слайдер похожим на нативный, и хотим поделиться им со всеми заинтересованными. Посмотреть на работу плагина можно, например, в ответе погоды или картинок на <a href="http://yandex.ru/touchsearch?text=Погода">новой странице результатов поиска</a> для iPhone и iPod Touch.</p>
<p>В отличие от обычного CSS3 Transform, «3D» задействует аппаратное GPU ускорение в iOS. Это позволяет добиться очень плавной и приятной анимации. Сама тема аппаратного ускорения анимации достаточно обширна, в будущем на эту тему будет отдельная статья.</p>
<p>Чтобы слайдер ощущался нативным, мы учли множество мелочей:</p>
<ul>
<li>если свайп-жест длинный, сразу на несколько пунктов, то слайдер это поймёт;</li>
<li>если свайпнуть меньше, чем на один шаг, при этом не преодолев заданный порог (по умолчанию 30 пикселей), то слайдер «отпружинит» назад;</li>
<li>слайдер так же отпружинит назад при попытке свайпнуть за левый или правый предел.</li>
</ul>
<h2 id="-">Зависимость от скорости жеста</h2>
<p>Чтобы слайдер вёл себя более живо и соответствовал ожиданиям от жеста, мы научили его понимать ускорение. Оно рассчитывается по следующей формуле (условия и значения для неё подбирались экспериментально):</p>
<pre><code>accel = speed &gt; 0.3 &amp;&amp; speed &lt; 0.6 ? 2 :
speed &gt;= 0.6 &amp;&amp; speed &lt; 1 ? 3 :
speed &gt;= 1 ? 4 :
1;
</code></pre><p>Где speed — расстояние от начала до конца свайп-жеста, делённое на его время (школьные знания «v = s / t» наконец-то пригодились :)</p>
<p>Среднестатистический свайп-жест — примерно <nobr>0.4-0.6</nobr> пикселей в миллисекунду. Есть совсем небольшой, но всё же заметный разброс во времени анимации CSS Transition:</p>
<pre><code>animationTime = accel &gt;= 3 ? &#39;0.3&#39; : &#39;0.2&#39;;
</code></pre><p>После него шаг умножается на значение акселерации и происходит анимация.</p>
<h2 id="-api">Внешнее API</h2>
<p>При навешивании слайдера на блок можно указать callback-функцию. Она будет вызываться при каждом свайпе с пробрасываемым набором всех необходимых данных — скорость, шаг, пределы, время и прочее. Также слайдер можно подвинуть и без помощи пальца, затриггерив на блок слайдера события <code>slideLeft([шаг])</code> или <code>slideRight([шаг])</code>.</p>
<h2 id="-fork-us-on-github-">“Fork us on GitHub”</h2>
<p>Посмотреть или скачать код плагина с комментариями можно <a href="https://github.com/yandex-ui/yaTouchSlider">в репозитории проекта на Гитхабе</a>.</p>
</div></div><!-- Yandex.Metrika counter --><div style="display:none;"><script type="text/javascript">(function(w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter8530063 = new Ya.Metrika({id:8530063, enableAll: true}); } catch(e) { } }); })(window, "yandex_metrika_callbacks");</script></div><script src="//mc.yandex.ru/metrika/watch.js" type="text/javascript" defer="defer"></script><noscript><div><img src="//mc.yandex.ru/watch/8530063" style="position:absolute; left:-9999px;" alt="" /></div></noscript><!-- /Yandex.Metrika counter --></body></html>